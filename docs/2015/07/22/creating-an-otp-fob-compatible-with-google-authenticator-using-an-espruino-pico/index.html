<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  	<meta property="og:title" content=" Creating an OTP fob compatible with Google Authenticator using an Espruino Pico &middot;  Cross Dominant" />
  	<meta property="og:site_name" content="Cross Dominant" />
  	<meta property="og:url" content="https://conoroneill.net/2015/07/22/creating-an-otp-fob-compatible-with-google-authenticator-using-an-espruino-pico/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2015-07-22T08:14:26&#43;01:00" />

    
    

  <title>
     Creating an OTP fob compatible with Google Authenticator using an Espruino Pico &middot;  Cross Dominant
  </title>

    <meta name="description" content="Mixed laterality since 1968" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://conoroneill.net/favicon.ico">
	  <link rel="apple-touch-icon" href="https://conoroneill.net/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="https://conoroneill.net/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="https://conoroneill.net/css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz"
    crossorigin="anonymous">



    
      
          <link href="https://conoroneill.net/index.xml" rel="alternate" type="application/rss+xml" title="Cross Dominant" />
      
      
    
    <meta name="generator" content="Hugo 0.84.4" />

    <link rel="canonical" href="https://conoroneill.net/2015/07/22/creating-an-otp-fob-compatible-with-google-authenticator-using-an-espruino-pico/" />

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-88610-4', 'auto');
      ga('send', 'pageview');

    </script>
    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        

        
    </ul>


    
    <a class="subscribe-button icon-feed" href="https://conoroneill.net/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
      <a class="blog-logo" href="https://conoroneill.net/"><img src="https://conoroneill.net/images/cross_dominant.png" alt="Home" /></a>
  
  
      <a class="menu-button icon-feed" href="https://conoroneill.net/index.xml">&nbsp;&nbsp;Subscribe</a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Creating an OTP fob compatible with Google Authenticator using an Espruino Pico</h1>
        <small>Now that the Espruino Pico has (beta) HID support, it can pretend to be a keyboard or mouse (or other HID compatible device). This makes it possible to send characters to the active window on your Windows/Linux/Mac PC. I&#39;ve cobbled together some code which turns the Pico into a device like a YubiKey. Press the button and get the latest auth code pasted automatically for you.</small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2015-07-22T08:14:26&#43;01:00">
            Jul 22, 2015
          </time>
        
         
        </section>
    </header>

    <section class="post-content">
      <p>Now that the <a href="http://www.espruino.com/">Espruino Pico</a> has (beta) HID support, it can pretend to be a keyboard or mouse (or other HID compatible device). This makes it possible to send characters to the active window on your Windows/Linux/Mac PC. I&rsquo;ve cobbled together some code which turns the Pico into a device like a YubiKey. Press the button and get the latest auth code pasted automatically for you.</p>
<p><img src="https://s3-eu-west-1.amazonaws.com/conoroneill.net/wp-content/uploads/2015/07/espruino_otp.jpg" alt="Espruino Pico OTP"></p>
<p>This code is basically just from three sources, merged together with a few tiny tweaks by me.</p>
<ul>
<li><a href="https://github.com/Caligatio/jsSHA">jsSHA, a JavaScript implementation of SHA/HMAC</a></li>
<li><a href="https://blog.nraboy.com/2014/10/generate-time-based-one-time-passwords-javascript/">Generate Time-Based One-Time Passwords With JavaScript</a></li>
<li><a href="http://www.espruino.com/USB">Espruino HID Example</a></li>
</ul>
<p>(Note I&rsquo;ve just discovered that Espruino has its own hmac implementation so I can possibly drop jsSHA)</p>
<p>The main thing you need for this is your Google Authenticator Secret. Unfortunately you can only get this when you have access to the original QR code that you scanned (it&rsquo;s in the URL). But if you are setting up 2FA access to a new service e.g. Digital Ocean, then you can grab the secret and save it in the code. If your system also uses a PIN (e.g. SSO on some corporate sites), save that in the code too.</p>
<p>You&rsquo;ll need a very recent pre-release Firmware for this to work at all e.g. <a href="http://www.espruino.com/binaries/git/commits/d3b43aab7efcc42e6f1584c340bd855b1e5af4c6/">from here</a></p>
<p>Once that&rsquo;s flashed, go into Settings on the Web IDE and make sure &ldquo;Set Current Time&rdquo; is ticked in the Communications section. Auth Fobs rely on having an accurate time and that setting keeps unsetting itself on my PC.</p>
<p>Now copy the code below onto the Espruino using the Web IDE and then type save() to make sure it can survive a power-cycle. Remove and re-insert the Pico, press the button and you should get the auth code you need.</p>
<p>Now for the bad news: This currently doesn&rsquo;t work on my Windows 8.1 PC but works semi-reliably on my work MBP. Once the HID code makes it to production, I&rsquo;m sure it will work fine.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// Code assembled by Conor O&#39;Neill from three sources. None of it copyright me.
</span><span style="color:#75715e">// This code copyright Brian Turek https://github.com/Caligatio/jsSHA https://github.com/Caligatio/jsSHA/blob/master/LICENSE
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;use strict&#39;</span>;(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">E</span>){<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">t</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">e</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span>[],<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,<span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">k</span>,<span style="color:#a6e22e">l</span>,<span style="color:#a6e22e">h</span>,<span style="color:#a6e22e">m</span>,<span style="color:#a6e22e">w</span>,<span style="color:#a6e22e">n</span>,<span style="color:#a6e22e">q</span><span style="color:#f92672">=!</span><span style="color:#ae81ff">1</span>,<span style="color:#a6e22e">r</span><span style="color:#f92672">=!</span><span style="color:#ae81ff">1</span>,<span style="color:#a6e22e">p</span><span style="color:#f92672">=</span>[],<span style="color:#a6e22e">t</span><span style="color:#f92672">=</span>[],<span style="color:#a6e22e">v</span>,<span style="color:#a6e22e">u</span><span style="color:#f92672">=!</span><span style="color:#ae81ff">1</span>;<span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span><span style="color:#f92672">||</span>{};<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">encoding</span><span style="color:#f92672">||</span><span style="color:#e6db74">&#34;UTF8&#34;</span>;<span style="color:#a6e22e">v</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">numRounds</span><span style="color:#f92672">||</span><span style="color:#ae81ff">1</span>;<span style="color:#a6e22e">l</span><span style="color:#f92672">=</span><span style="color:#a6e22e">y</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">f</span>);<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">v</span><span style="color:#f92672">!==</span>parseInt(<span style="color:#a6e22e">v</span>,<span style="color:#ae81ff">10</span>)<span style="color:#f92672">||</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">v</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;numRounds must a integer &gt;= 1&#34;</span>);<span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;SHA-1&#34;</span><span style="color:#f92672">===</span><span style="color:#a6e22e">c</span>)<span style="color:#a6e22e">m</span><span style="color:#f92672">=</span><span style="color:#ae81ff">512</span>,<span style="color:#a6e22e">w</span><span style="color:#f92672">=</span><span style="color:#a6e22e">z</span>,<span style="color:#a6e22e">n</span><span style="color:#f92672">=</span><span style="color:#a6e22e">F</span>,<span style="color:#a6e22e">h</span><span style="color:#f92672">=</span><span style="color:#ae81ff">160</span>;<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;Chosen SHA variant is not supported&#34;</span>);<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">x</span>(<span style="color:#a6e22e">c</span>);<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setHMACKey</span><span style="color:#f92672">=</span><span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">e</span>;<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#ae81ff">0</span><span style="color:#f92672">===</span><span style="color:#a6e22e">r</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;HMAC key already set&#34;</span>);<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#ae81ff">0</span><span style="color:#f92672">===</span><span style="color:#a6e22e">q</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;Cannot set HMAC key after finalizing hash&#34;</span>);<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#ae81ff">0</span><span style="color:#f92672">===</span><span style="color:#a6e22e">u</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;Cannot set HMAC key after calling update&#34;</span>);
<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span>(<span style="color:#a6e22e">d</span><span style="color:#f92672">||</span>{}).<span style="color:#a6e22e">encoding</span><span style="color:#f92672">||</span><span style="color:#e6db74">&#34;UTF8&#34;</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#a6e22e">y</span>(<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">f</span>)(<span style="color:#a6e22e">a</span>);<span style="color:#a6e22e">a</span><span style="color:#f92672">=</span><span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">binLen</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">value</span>;<span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">3</span>;<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span><span style="color:#f92672">/</span><span style="color:#ae81ff">4</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">e</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">a</span><span style="color:#f92672">/</span><span style="color:#ae81ff">8</span>){<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#a6e22e">n</span>(<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">a</span>,<span style="color:#ae81ff">0</span>,<span style="color:#a6e22e">x</span>(<span style="color:#a6e22e">c</span>));<span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">d</span>;)<span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>);<span style="color:#a6e22e">b</span>[<span style="color:#a6e22e">d</span>]<span style="color:#f92672">&amp;=</span><span style="color:#ae81ff">4294967040</span>}<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">e</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">a</span><span style="color:#f92672">/</span><span style="color:#ae81ff">8</span>){<span style="color:#66d9ef">for</span>(;<span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">d</span>;)<span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>);<span style="color:#a6e22e">b</span>[<span style="color:#a6e22e">d</span>]<span style="color:#f92672">&amp;=</span><span style="color:#ae81ff">4294967040</span>}<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">a</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">a</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">d</span>;<span style="color:#a6e22e">a</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>)<span style="color:#a6e22e">p</span>[<span style="color:#a6e22e">a</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">b</span>[<span style="color:#a6e22e">a</span>]<span style="color:#f92672">^</span><span style="color:#ae81ff">909522486</span>,<span style="color:#a6e22e">t</span>[<span style="color:#a6e22e">a</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">b</span>[<span style="color:#a6e22e">a</span>]<span style="color:#f92672">^</span><span style="color:#ae81ff">1549556828</span>;<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">w</span>(<span style="color:#a6e22e">p</span>,<span style="color:#a6e22e">k</span>);<span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span>;<span style="color:#a6e22e">r</span><span style="color:#f92672">=!</span><span style="color:#ae81ff">0</span>};<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">update</span><span style="color:#f92672">=</span><span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">e</span>,<span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">h</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,<span style="color:#a6e22e">n</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">5</span>;<span style="color:#a6e22e">c</span><span style="color:#f92672">=</span><span style="color:#a6e22e">l</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>);<span style="color:#a6e22e">a</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">binLen</span>;<span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">value</span>;<span style="color:#a6e22e">c</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">5</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">f</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">c</span>;<span style="color:#a6e22e">f</span><span style="color:#f92672">+=</span><span style="color:#a6e22e">n</span>)<span style="color:#a6e22e">h</span><span style="color:#f92672">+</span><span style="color:#a6e22e">m</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">a</span><span style="color:#f92672">&amp;&amp;</span>(<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">w</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">f</span><span style="color:#f92672">+</span><span style="color:#a6e22e">n</span>),<span style="color:#a6e22e">k</span>),<span style="color:#a6e22e">h</span><span style="color:#f92672">+=</span><span style="color:#a6e22e">m</span>);<span style="color:#a6e22e">g</span><span style="color:#f92672">+=</span><span style="color:#a6e22e">h</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#a6e22e">h</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">5</span>);<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span><span style="color:#f92672">%</span><span style="color:#a6e22e">m</span>;<span style="color:#a6e22e">u</span><span style="color:#f92672">=!</span><span style="color:#ae81ff">0</span>};<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getHash</span><span style="color:#f92672">=</span><span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">e</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">l</span>,<span style="color:#a6e22e">m</span>;<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#ae81ff">0</span><span style="color:#f92672">===</span>
<span style="color:#a6e22e">r</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;Cannot call getHash after setting HMAC key&#34;</span>);<span style="color:#a6e22e">m</span><span style="color:#f92672">=</span><span style="color:#a6e22e">A</span>(<span style="color:#a6e22e">e</span>);<span style="color:#66d9ef">switch</span>(<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;HEX&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">B</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">m</span>)};<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;B64&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">C</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">m</span>)};<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;BYTES&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">D</span>;<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">default</span><span style="color:#f92672">:</span><span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;format must be HEX, B64, or BYTES&#34;</span>);}<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#ae81ff">1</span><span style="color:#f92672">===</span><span style="color:#a6e22e">q</span>)<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">n</span>(<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">g</span>,<span style="color:#a6e22e">k</span>),<span style="color:#a6e22e">l</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;<span style="color:#a6e22e">l</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">v</span>;<span style="color:#a6e22e">l</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>)<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">n</span>(<span style="color:#a6e22e">k</span>,<span style="color:#a6e22e">h</span>,<span style="color:#ae81ff">0</span>,<span style="color:#a6e22e">x</span>(<span style="color:#a6e22e">c</span>));<span style="color:#a6e22e">q</span><span style="color:#f92672">=!</span><span style="color:#ae81ff">0</span>;<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">k</span>)};<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getHMAC</span><span style="color:#f92672">=</span><span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">e</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">l</span>,<span style="color:#a6e22e">p</span>;<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#ae81ff">1</span><span style="color:#f92672">===</span><span style="color:#a6e22e">r</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;Cannot call getHMAC without first setting HMAC key&#34;</span>);<span style="color:#a6e22e">p</span><span style="color:#f92672">=</span><span style="color:#a6e22e">A</span>(<span style="color:#a6e22e">e</span>);<span style="color:#66d9ef">switch</span>(<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;HEX&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">B</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">p</span>)};<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;B64&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">f</span><span style="color:#f92672">=</span>
<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">C</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">p</span>)};<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;BYTES&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">D</span>;<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">default</span><span style="color:#f92672">:</span><span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;outputFormat must be HEX, B64, or BYTES&#34;</span>);}<span style="color:#f92672">!</span><span style="color:#ae81ff">1</span><span style="color:#f92672">===</span><span style="color:#a6e22e">q</span><span style="color:#f92672">&amp;&amp;</span>(<span style="color:#a6e22e">l</span><span style="color:#f92672">=</span><span style="color:#a6e22e">n</span>(<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">g</span>,<span style="color:#a6e22e">k</span>),<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">w</span>(<span style="color:#a6e22e">t</span>,<span style="color:#a6e22e">x</span>(<span style="color:#a6e22e">c</span>)),<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">n</span>(<span style="color:#a6e22e">l</span>,<span style="color:#a6e22e">h</span>,<span style="color:#a6e22e">m</span>,<span style="color:#a6e22e">k</span>));<span style="color:#a6e22e">q</span><span style="color:#f92672">=!</span><span style="color:#ae81ff">0</span>;<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">k</span>)}}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">G</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">e</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span>,<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">k</span>,<span style="color:#a6e22e">l</span>;<span style="color:#a6e22e">a</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span><span style="color:#f92672">||</span>[<span style="color:#ae81ff">0</span>];<span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span><span style="color:#f92672">||</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">l</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">3</span>;<span style="color:#66d9ef">if</span>(<span style="color:#ae81ff">0</span><span style="color:#f92672">!==</span><span style="color:#a6e22e">g</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;String of HEX type must be in byte increments&#34;</span>);<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">g</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">2</span>){<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span>parseInt(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#a6e22e">b</span>,<span style="color:#ae81ff">2</span>),<span style="color:#ae81ff">16</span>);<span style="color:#66d9ef">if</span>(isNaN(<span style="color:#a6e22e">d</span>))<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;String of HEX type contains invalid characters&#34;</span>);<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">+</span><span style="color:#a6e22e">l</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">k</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">2</span>;<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">f</span>;)<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>);<span style="color:#a6e22e">a</span>[<span style="color:#a6e22e">f</span>]<span style="color:#f92672">|=</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&lt;&lt;</span>
<span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#a6e22e">k</span><span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>)}<span style="color:#66d9ef">return</span>{<span style="color:#a6e22e">value</span><span style="color:#f92672">:</span><span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">binLen</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span><span style="color:#f92672">*</span><span style="color:#a6e22e">g</span><span style="color:#f92672">+</span><span style="color:#a6e22e">e</span>}}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">H</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">e</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">g</span><span style="color:#f92672">=</span>[],<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">k</span>,<span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span><span style="color:#f92672">||</span>[<span style="color:#ae81ff">0</span>];<span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span><span style="color:#f92672">||</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">3</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>)<span style="color:#a6e22e">a</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">b</span>),<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">b</span><span style="color:#f92672">+</span><span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">k</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">2</span>,<span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">f</span><span style="color:#f92672">&amp;&amp;</span><span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>),<span style="color:#a6e22e">g</span>[<span style="color:#a6e22e">f</span>]<span style="color:#f92672">|=</span><span style="color:#a6e22e">a</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#a6e22e">k</span><span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>);<span style="color:#66d9ef">return</span>{<span style="color:#a6e22e">value</span><span style="color:#f92672">:</span><span style="color:#a6e22e">g</span>,<span style="color:#a6e22e">binLen</span><span style="color:#f92672">:</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">+</span><span style="color:#a6e22e">e</span>}}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">I</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">e</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">g</span><span style="color:#f92672">=</span>[],<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">k</span>,<span style="color:#a6e22e">l</span>,<span style="color:#a6e22e">h</span>,<span style="color:#a6e22e">m</span>,<span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span><span style="color:#f92672">||</span>[<span style="color:#ae81ff">0</span>];<span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span><span style="color:#f92672">||</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">a</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">3</span>;<span style="color:#66d9ef">if</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">===</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">search</span>(<span style="color:#e6db74">/^[a-zA-Z0-9=+\/]+$/</span>))<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;Invalid character in base-64 string&#34;</span>);<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;=&#34;</span>);<span style="color:#a6e22e">c</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\=/g</span>,<span style="color:#e6db74">&#34;&#34;</span>);<span style="color:#66d9ef">if</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">!==</span><span style="color:#a6e22e">f</span><span style="color:#f92672">&amp;&amp;</span><span style="color:#a6e22e">f</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;Invalid &#39;=&#39; found in base-64 string&#34;</span>);
<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">f</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span>;<span style="color:#a6e22e">f</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">4</span>){<span style="color:#a6e22e">h</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#a6e22e">f</span>,<span style="color:#ae81ff">4</span>);<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">l</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">k</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">length</span>;<span style="color:#a6e22e">k</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>)<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#a6e22e">h</span>[<span style="color:#a6e22e">k</span>]),<span style="color:#a6e22e">l</span><span style="color:#f92672">|=</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">18</span><span style="color:#f92672">-</span><span style="color:#ae81ff">6</span><span style="color:#f92672">*</span><span style="color:#a6e22e">k</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">k</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;<span style="color:#a6e22e">k</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>){<span style="color:#a6e22e">m</span><span style="color:#f92672">=</span><span style="color:#a6e22e">b</span><span style="color:#f92672">+</span><span style="color:#a6e22e">a</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">2</span>;<span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">d</span>;)<span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>);<span style="color:#a6e22e">g</span>[<span style="color:#a6e22e">d</span>]<span style="color:#f92672">|=</span>(<span style="color:#a6e22e">l</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span><span style="color:#f92672">-</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span><span style="color:#a6e22e">k</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">255</span>)<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#a6e22e">m</span><span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>);<span style="color:#a6e22e">b</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>}}<span style="color:#66d9ef">return</span>{<span style="color:#a6e22e">value</span><span style="color:#f92672">:</span><span style="color:#a6e22e">g</span>,<span style="color:#a6e22e">binLen</span><span style="color:#f92672">:</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span><span style="color:#a6e22e">b</span><span style="color:#f92672">+</span><span style="color:#a6e22e">e</span>}}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">B</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#ae81ff">4</span><span style="color:#f92672">*</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span>,<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">g</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>)<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>[<span style="color:#a6e22e">b</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#a6e22e">b</span><span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>),<span style="color:#a6e22e">e</span><span style="color:#f92672">+=</span><span style="color:#e6db74">&#34;0123456789abcdef&#34;</span>.<span style="color:#a6e22e">charAt</span>(<span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">4</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">15</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;0123456789abcdef&#34;</span>.<span style="color:#a6e22e">charAt</span>(<span style="color:#a6e22e">d</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">15</span>);<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">outputUpper</span><span style="color:#f92672">?</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">toUpperCase</span>()<span style="color:#f92672">:</span><span style="color:#a6e22e">e</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">C</span>(<span style="color:#a6e22e">c</span>,
<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#ae81ff">4</span><span style="color:#f92672">*</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span>,<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">f</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">g</span>;<span style="color:#a6e22e">b</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">3</span>)<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">b</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">2</span>,<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">f</span><span style="color:#f92672">?</span><span style="color:#ae81ff">0</span><span style="color:#f92672">:</span><span style="color:#a6e22e">c</span>[<span style="color:#a6e22e">f</span>],<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">b</span><span style="color:#f92672">+</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">2</span>,<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">f</span><span style="color:#f92672">?</span><span style="color:#ae81ff">0</span><span style="color:#f92672">:</span><span style="color:#a6e22e">c</span>[<span style="color:#a6e22e">f</span>],<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span>(<span style="color:#a6e22e">c</span>[<span style="color:#a6e22e">b</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#a6e22e">b</span><span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">255</span>)<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">16</span><span style="color:#f92672">|</span>(<span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">255</span>)<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">|</span><span style="color:#a6e22e">f</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">255</span>,<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#ae81ff">4</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">d</span>;<span style="color:#a6e22e">d</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>)<span style="color:#ae81ff">8</span><span style="color:#f92672">*</span><span style="color:#a6e22e">b</span><span style="color:#f92672">+</span><span style="color:#ae81ff">6</span><span style="color:#f92672">*</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">32</span><span style="color:#f92672">*</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">?</span><span style="color:#a6e22e">e</span><span style="color:#f92672">+=</span><span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;</span>.<span style="color:#a6e22e">charAt</span>(<span style="color:#a6e22e">f</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">6</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#a6e22e">d</span>)<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">63</span>)<span style="color:#f92672">:</span><span style="color:#a6e22e">e</span><span style="color:#f92672">+=</span><span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">b64Pad</span>;<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">e</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">D</span>(<span style="color:#a6e22e">c</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">a</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#ae81ff">4</span><span style="color:#f92672">*</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span>,<span style="color:#a6e22e">g</span>,<span style="color:#a6e22e">b</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">g</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">e</span>;<span style="color:#a6e22e">g</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>)<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>[<span style="color:#a6e22e">g</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#a6e22e">g</span><span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">255</span>,<span style="color:#a6e22e">a</span><span style="color:#f92672">+=</span>String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#a6e22e">b</span>);<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">A</span>(<span style="color:#a6e22e">c</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">a</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">outputUpper</span><span style="color:#f92672">:!</span><span style="color:#ae81ff">1</span>,<span style="color:#a6e22e">b64Pad</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;=&#34;</span>};
<span style="color:#a6e22e">c</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span><span style="color:#f92672">||</span>{};<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">outputUpper</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">outputUpper</span><span style="color:#f92672">||!</span><span style="color:#ae81ff">1</span>;<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">b64Pad</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">b64Pad</span><span style="color:#f92672">||</span><span style="color:#e6db74">&#34;=&#34;</span>;<span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;boolean&#34;</span><span style="color:#f92672">!==</span><span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">outputUpper</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;Invalid outputUpper formatting option&#34;</span>);<span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;string&#34;</span><span style="color:#f92672">!==</span><span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">b64Pad</span>)<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;Invalid b64Pad formatting option&#34;</span>);<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">y</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">e</span>;<span style="color:#66d9ef">switch</span>(<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;UTF8&#34;</span><span style="color:#f92672">:</span><span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;UTF16BE&#34;</span><span style="color:#f92672">:</span><span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;UTF16LE&#34;</span><span style="color:#f92672">:</span><span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">default</span><span style="color:#f92672">:</span><span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;encoding must be UTF8, UTF16BE, or UTF16LE&#34;</span>);}<span style="color:#66d9ef">switch</span>(<span style="color:#a6e22e">c</span>){<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;HEX&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">G</span>;<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;TEXT&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>,<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span><span style="color:#f92672">=</span>[],<span style="color:#a6e22e">c</span><span style="color:#f92672">=</span>[],<span style="color:#a6e22e">l</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,<span style="color:#a6e22e">h</span>,<span style="color:#a6e22e">m</span>,<span style="color:#a6e22e">p</span>,<span style="color:#a6e22e">n</span>,<span style="color:#a6e22e">q</span>,<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">b</span><span style="color:#f92672">||</span>[<span style="color:#ae81ff">0</span>];<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span><span style="color:#f92672">||</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">p</span><span style="color:#f92672">=</span><span style="color:#a6e22e">b</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">3</span>;<span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;UTF8&#34;</span><span style="color:#f92672">===</span>
<span style="color:#a6e22e">a</span>)<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">h</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">h</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">length</span>;<span style="color:#a6e22e">h</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>)<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">h</span>),<span style="color:#a6e22e">c</span><span style="color:#f92672">=</span>[],<span style="color:#ae81ff">128</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">d</span><span style="color:#f92672">?</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">d</span>)<span style="color:#f92672">:</span><span style="color:#ae81ff">2048</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">d</span><span style="color:#f92672">?</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">192</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">6</span>),<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">128</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">63</span>))<span style="color:#f92672">:</span><span style="color:#ae81ff">55296</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">d</span><span style="color:#f92672">||</span><span style="color:#ae81ff">57344</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">d</span><span style="color:#f92672">?</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">224</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">128</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">6</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">128</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">63</span>)<span style="color:#f92672">:</span>(<span style="color:#a6e22e">h</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>,<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#ae81ff">65536</span><span style="color:#f92672">+</span>((<span style="color:#a6e22e">d</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1023</span>)<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">10</span><span style="color:#f92672">|</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">h</span>)<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1023</span>),<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">240</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">128</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">12</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">128</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">6</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">128</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">63</span>)),<span style="color:#a6e22e">m</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">m</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span>;<span style="color:#a6e22e">m</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>){<span style="color:#a6e22e">q</span><span style="color:#f92672">=</span><span style="color:#a6e22e">l</span><span style="color:#f92672">+</span><span style="color:#a6e22e">p</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">n</span><span style="color:#f92672">=</span><span style="color:#a6e22e">q</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">2</span>;<span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">n</span>;)<span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>);<span style="color:#a6e22e">f</span>[<span style="color:#a6e22e">n</span>]<span style="color:#f92672">|=</span><span style="color:#a6e22e">c</span>[<span style="color:#a6e22e">m</span>]<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#a6e22e">q</span><span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>);<span style="color:#a6e22e">l</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>}<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;UTF16BE&#34;</span><span style="color:#f92672">===</span><span style="color:#a6e22e">a</span><span style="color:#f92672">||</span><span style="color:#e6db74">&#34;UTF16LE&#34;</span><span style="color:#f92672">===</span><span style="color:#a6e22e">a</span>)<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">h</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">h</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">length</span>;<span style="color:#a6e22e">h</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>){<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">h</span>);<span style="color:#e6db74">&#34;UTF16LE&#34;</span><span style="color:#f92672">===</span><span style="color:#a6e22e">a</span><span style="color:#f92672">&amp;&amp;</span>(<span style="color:#a6e22e">m</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">255</span>,<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">8</span>);<span style="color:#a6e22e">q</span><span style="color:#f92672">=</span><span style="color:#a6e22e">l</span><span style="color:#f92672">+</span><span style="color:#a6e22e">p</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">n</span><span style="color:#f92672">=</span><span style="color:#a6e22e">q</span><span style="color:#f92672">&gt;&gt;&gt;</span>
<span style="color:#ae81ff">2</span>;<span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">n</span>;)<span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>);<span style="color:#a6e22e">f</span>[<span style="color:#a6e22e">n</span>]<span style="color:#f92672">|=</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">-</span><span style="color:#a6e22e">q</span><span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>);<span style="color:#a6e22e">l</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">2</span>}<span style="color:#66d9ef">return</span>{<span style="color:#a6e22e">value</span><span style="color:#f92672">:</span><span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">binLen</span><span style="color:#f92672">:</span><span style="color:#ae81ff">8</span><span style="color:#f92672">*</span><span style="color:#a6e22e">l</span><span style="color:#f92672">+</span><span style="color:#a6e22e">b</span>}};<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;B64&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">I</span>;<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;BYTES&#34;</span><span style="color:#f92672">:</span><span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">H</span>;<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">default</span><span style="color:#f92672">:</span><span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;format must be HEX, TEXT, B64, or BYTES&#34;</span>);}<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">e</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">r</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">c</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#a6e22e">a</span><span style="color:#f92672">|</span><span style="color:#a6e22e">c</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">32</span><span style="color:#f92672">-</span><span style="color:#a6e22e">a</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">p</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">e</span><span style="color:#f92672">=</span>(<span style="color:#a6e22e">c</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">a</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>);<span style="color:#66d9ef">return</span>((<span style="color:#a6e22e">c</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">a</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">e</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>)<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">16</span><span style="color:#f92672">|</span><span style="color:#a6e22e">e</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">u</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">e</span>,<span style="color:#a6e22e">g</span>,<span style="color:#a6e22e">b</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">d</span><span style="color:#f92672">=</span>(<span style="color:#a6e22e">c</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">a</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">e</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">g</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>);<span style="color:#66d9ef">return</span>((<span style="color:#a6e22e">c</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">a</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">e</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">g</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">+</span>(<span style="color:#a6e22e">d</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>)<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">16</span><span style="color:#f92672">|</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">65535</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">x</span>(<span style="color:#a6e22e">c</span>){<span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;SHA-1&#34;</span><span style="color:#f92672">===</span>
<span style="color:#a6e22e">c</span>)<span style="color:#a6e22e">c</span><span style="color:#f92672">=</span>[<span style="color:#ae81ff">1732584193</span>,<span style="color:#ae81ff">4023233417</span>,<span style="color:#ae81ff">2562383102</span>,<span style="color:#ae81ff">271733878</span>,<span style="color:#ae81ff">3285377520</span>];<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#34;No SHA variants supported&#34;</span>);<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">c</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">z</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">e</span><span style="color:#f92672">=</span>[],<span style="color:#a6e22e">g</span>,<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">k</span>,<span style="color:#a6e22e">l</span>,<span style="color:#a6e22e">h</span>;<span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">0</span>];<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">1</span>];<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">2</span>];<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">3</span>];<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">4</span>];<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">h</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#ae81ff">80</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">h</span>;<span style="color:#a6e22e">h</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>)<span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">h</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">h</span><span style="color:#f92672">?</span><span style="color:#a6e22e">c</span>[<span style="color:#a6e22e">h</span>]<span style="color:#f92672">:</span><span style="color:#a6e22e">r</span>(<span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">h</span><span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>]<span style="color:#f92672">^</span><span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">h</span><span style="color:#f92672">-</span><span style="color:#ae81ff">8</span>]<span style="color:#f92672">^</span><span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">h</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span>]<span style="color:#f92672">^</span><span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">h</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>],<span style="color:#ae81ff">1</span>),<span style="color:#a6e22e">l</span><span style="color:#f92672">=</span><span style="color:#ae81ff">20</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">h</span><span style="color:#f92672">?</span><span style="color:#a6e22e">u</span>(<span style="color:#a6e22e">r</span>(<span style="color:#a6e22e">g</span>,<span style="color:#ae81ff">5</span>),<span style="color:#a6e22e">b</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">d</span><span style="color:#f92672">^~</span><span style="color:#a6e22e">b</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">k</span>,<span style="color:#ae81ff">1518500249</span>,<span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">h</span>])<span style="color:#f92672">:</span><span style="color:#ae81ff">40</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">h</span><span style="color:#f92672">?</span><span style="color:#a6e22e">u</span>(<span style="color:#a6e22e">r</span>(<span style="color:#a6e22e">g</span>,<span style="color:#ae81ff">5</span>),<span style="color:#a6e22e">b</span><span style="color:#f92672">^</span><span style="color:#a6e22e">d</span><span style="color:#f92672">^</span><span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">k</span>,<span style="color:#ae81ff">1859775393</span>,<span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">h</span>])<span style="color:#f92672">:</span><span style="color:#ae81ff">60</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">h</span><span style="color:#f92672">?</span><span style="color:#a6e22e">u</span>(<span style="color:#a6e22e">r</span>(<span style="color:#a6e22e">g</span>,<span style="color:#ae81ff">5</span>),<span style="color:#a6e22e">b</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">d</span><span style="color:#f92672">^</span><span style="color:#a6e22e">b</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">f</span><span style="color:#f92672">^</span><span style="color:#a6e22e">d</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">k</span>,<span style="color:#ae81ff">2400959708</span>,<span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">h</span>])<span style="color:#f92672">:</span><span style="color:#a6e22e">u</span>(<span style="color:#a6e22e">r</span>(<span style="color:#a6e22e">g</span>,<span style="color:#ae81ff">5</span>),<span style="color:#a6e22e">b</span><span style="color:#f92672">^</span><span style="color:#a6e22e">d</span><span style="color:#f92672">^</span><span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">k</span>,<span style="color:#ae81ff">3395469782</span>,<span style="color:#a6e22e">e</span>[<span style="color:#a6e22e">h</span>]),<span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#a6e22e">r</span>(<span style="color:#a6e22e">b</span>,<span style="color:#ae81ff">30</span>),<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span><span style="color:#a6e22e">g</span>,<span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#a6e22e">l</span>;<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">p</span>(<span style="color:#a6e22e">g</span>,<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">0</span>]);<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">p</span>(<span style="color:#a6e22e">b</span>,<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">1</span>]);<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">p</span>(<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">2</span>]);<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">p</span>(<span style="color:#a6e22e">f</span>,<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">3</span>]);
<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">p</span>(<span style="color:#a6e22e">k</span>,<span style="color:#a6e22e">a</span>[<span style="color:#ae81ff">4</span>]);<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">a</span>}<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">F</span>(<span style="color:#a6e22e">c</span>,<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">e</span>,<span style="color:#a6e22e">g</span>){<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">b</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">b</span><span style="color:#f92672">=</span>(<span style="color:#a6e22e">a</span><span style="color:#f92672">+</span><span style="color:#ae81ff">65</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">9</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">15</span>;<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">&lt;=</span><span style="color:#a6e22e">b</span>;)<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>);<span style="color:#a6e22e">c</span>[<span style="color:#a6e22e">a</span><span style="color:#f92672">&gt;&gt;&gt;</span><span style="color:#ae81ff">5</span>]<span style="color:#f92672">|=</span><span style="color:#ae81ff">128</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">24</span><span style="color:#f92672">-</span><span style="color:#a6e22e">a</span><span style="color:#f92672">%</span><span style="color:#ae81ff">32</span>;<span style="color:#a6e22e">c</span>[<span style="color:#a6e22e">b</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">a</span><span style="color:#f92672">+</span><span style="color:#a6e22e">e</span>;<span style="color:#a6e22e">e</span><span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">length</span>;<span style="color:#66d9ef">for</span>(<span style="color:#a6e22e">a</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">a</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">e</span>;<span style="color:#a6e22e">a</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">16</span>)<span style="color:#a6e22e">g</span><span style="color:#f92672">=</span><span style="color:#a6e22e">z</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">a</span><span style="color:#f92672">+</span><span style="color:#ae81ff">16</span>),<span style="color:#a6e22e">g</span>);<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">g</span>}<span style="color:#e6db74">&#34;function&#34;</span><span style="color:#f92672">===</span><span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">define</span><span style="color:#f92672">&amp;&amp;</span><span style="color:#a6e22e">define</span>.<span style="color:#a6e22e">amd</span><span style="color:#f92672">?</span><span style="color:#a6e22e">define</span>(<span style="color:#66d9ef">function</span>(){<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">t</span>})<span style="color:#f92672">:</span><span style="color:#e6db74">&#34;undefined&#34;</span><span style="color:#f92672">!==</span><span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">exports</span><span style="color:#f92672">?</span><span style="color:#e6db74">&#34;undefined&#34;</span><span style="color:#f92672">!==</span><span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">module</span><span style="color:#f92672">&amp;&amp;</span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span><span style="color:#f92672">?</span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span><span style="color:#f92672">=</span><span style="color:#a6e22e">exports</span><span style="color:#f92672">=</span><span style="color:#a6e22e">t</span><span style="color:#f92672">:</span><span style="color:#a6e22e">exports</span><span style="color:#f92672">=</span><span style="color:#a6e22e">t</span><span style="color:#f92672">:</span><span style="color:#a6e22e">E</span>.<span style="color:#a6e22e">jsSHA</span><span style="color:#f92672">=</span><span style="color:#a6e22e">t</span>})(<span style="color:#66d9ef">this</span>);

<span style="color:#75715e">// This code copyright Nic Raboy https://blog.nraboy.com/2014/10/generate-time-based-one-time-passwords-javascript/
</span><span style="color:#75715e"></span><span style="color:#a6e22e">TOTP</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>() {

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">dec2hex</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">s</span>) {
        <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">15.5</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">s</span>).<span style="color:#a6e22e">toString</span>(<span style="color:#ae81ff">16</span>);
    };

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">hex2dec</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">s</span>) {
        <span style="color:#66d9ef">return</span> parseInt(<span style="color:#a6e22e">s</span>, <span style="color:#ae81ff">16</span>);
    };

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">leftpad</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">s</span>, <span style="color:#a6e22e">l</span>, <span style="color:#a6e22e">p</span>) {
        <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">l</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">length</span>) {
            <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> Array(<span style="color:#a6e22e">l</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">length</span>).<span style="color:#a6e22e">join</span>(<span style="color:#a6e22e">p</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">s</span>;
        }
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">s</span>;
    };

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">base32tohex</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">base32</span>) {
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">base32chars</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span>;
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">bits</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">hex</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">base32</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">val</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">base32chars</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#a6e22e">base32</span>.<span style="color:#a6e22e">charAt</span>(<span style="color:#a6e22e">i</span>).<span style="color:#a6e22e">toUpperCase</span>());
            <span style="color:#a6e22e">bits</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">leftpad</span>(<span style="color:#a6e22e">val</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#ae81ff">2</span>), <span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#39;0&#39;</span>);
        }
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">bits</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">+=</span><span style="color:#ae81ff">4</span>) {
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">chunk</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">bits</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#a6e22e">i</span>, <span style="color:#ae81ff">4</span>);
            <span style="color:#a6e22e">hex</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">hex</span> <span style="color:#f92672">+</span> parseInt(<span style="color:#a6e22e">chunk</span>, <span style="color:#ae81ff">2</span>).<span style="color:#a6e22e">toString</span>(<span style="color:#ae81ff">16</span>) ;
        }
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">hex</span>;
    };

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getOTP</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">secret</span>) {
        <span style="color:#66d9ef">try</span> {
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">epoch</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">round</span>(<span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">getTime</span>() <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000.0</span>);
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">time</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">leftpad</span>(<span style="color:#a6e22e">dec2hex</span>(Math.<span style="color:#a6e22e">floor</span>(<span style="color:#a6e22e">epoch</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">30</span>)), <span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;0&#34;</span>);
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">hmacObj</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">jsSHA</span>(<span style="color:#e6db74">&#34;SHA-1&#34;</span>, <span style="color:#e6db74">&#34;HEX&#34;</span>);
			<span style="color:#a6e22e">hmacObj</span>.<span style="color:#a6e22e">setHMACKey</span>(<span style="color:#a6e22e">base32tohex</span>(<span style="color:#a6e22e">secret</span>), <span style="color:#e6db74">&#34;HEX&#34;</span>)
			<span style="color:#a6e22e">hmacObj</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">time</span>);
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">hmac</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">hmacObj</span>.<span style="color:#a6e22e">getHMAC</span>(<span style="color:#e6db74">&#34;HEX&#34;</span>);
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">offset</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">hex2dec</span>(<span style="color:#a6e22e">hmac</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#a6e22e">hmac</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>));
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">otp</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">hex2dec</span>(<span style="color:#a6e22e">hmac</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#a6e22e">offset</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#a6e22e">hex2dec</span>(<span style="color:#e6db74">&#34;7fffffff&#34;</span>)) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#34;</span>;
            <span style="color:#a6e22e">otp</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">otp</span>).<span style="color:#a6e22e">substr</span>(<span style="color:#a6e22e">otp</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">6</span>);
        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
            <span style="color:#66d9ef">throw</span> <span style="color:#a6e22e">error</span>;
        }
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">otp</span>;
    };

}

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">totpObj</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TOTP</span>();

<span style="color:#75715e">// This code copyright Gordon Williams, Pur3 Ltd.,  https://github.com/espruino/Espruino/blob/master/LICENSE
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">kb</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;USBKeyboard&#34;</span>);

<span style="color:#a6e22e">setWatch</span>(<span style="color:#66d9ef">function</span>() {
  <span style="color:#75715e">// These two lines by Conor O&#39;Neill :-)
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">pin</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;put_your_PIN_Prefix_here&#34;</span>;
  <span style="color:#a6e22e">kb</span>.<span style="color:#a6e22e">type</span>(<span style="color:#a6e22e">pin</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">totpObj</span>.<span style="color:#a6e22e">getOTP</span>(<span style="color:#e6db74">&#34;put_your_google_authenticator_secret_here&#34;</span>).<span style="color:#a6e22e">toString</span>(), <span style="color:#66d9ef">function</span>() {
        <span style="color:#a6e22e">kb</span>.<span style="color:#a6e22e">tap</span>(<span style="color:#a6e22e">kb</span>.<span style="color:#a6e22e">KEY</span>.<span style="color:#a6e22e">ENTER</span>);
    });
}, <span style="color:#a6e22e">BTN</span>, {<span style="color:#a6e22e">debounce</span><span style="color:#f92672">:</span><span style="color:#ae81ff">100</span>,<span style="color:#a6e22e">repeat</span><span style="color:#f92672">:</span><span style="color:#66d9ef">true</span>, <span style="color:#a6e22e">edge</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;rising&#34;</span>});

</code></pre></div>
    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="https://conoroneill.net/" style="background-image: url(https://conoroneill.net/images/cross_dominant.png)"><span class="hidden">Conor O&#39;Neill's Picture</span></a>
    </figure>
    

    





<section class="author">
  <h4><a href="https://conoroneill.net/">Conor O&#39;Neill</a></h4>
  
  <p>Tech guy who likes running slowly</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Bandon, Cork, Ireland</span>
    <span class="author-link icon-link"><a href="https://conoroneill.net">https://conoroneill.net</a></span>
  </div>
</section>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=Creating%20an%20OTP%20fob%20compatible%20with%20Google%20Authenticator%20using%20an%20Espruino%20Pico&amp;url=https%3a%2f%2fconoroneill.net%2f2015%2f07%2f22%2fcreating-an-otp-fob-compatible-with-google-authenticator-using-an-espruino-pico%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
</section>



    

    <div id="intensedebate_thread"></div>
<script type="text/javascript">
    var idcomments_acct = 'eabb81c6187279153955c50b258de90a';
    var idcomments_post_id;
    var idcomments_post_url;
</script>
<span id="IDCommentsPostTitle" style="display:none"></span>
<script type='text/javascript' src='https://www.intensedebate.com/js/genericCommentWrapperV2.js'></script>
<noscript>Please enable JavaScript to view the comments.</a></noscript>

    
  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Cross Dominant</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="https://conoroneill.net/js/jquery.js"></script>
    <script type="text/javascript" src="https://conoroneill.net/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://conoroneill.net/js/index.js"></script>
    
</body>
</html>

